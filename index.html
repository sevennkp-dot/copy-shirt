<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>üëï ‡∏£‡∏∞‡∏ö‡∏ö‡∏•‡∏≠‡∏Å‡∏•‡∏≤‡∏¢‡πÄ‡∏™‡∏∑‡πâ‡∏≠ (Canvas Demo)</title>
<style>
  body{font-family:Arial,Helvetica,sans-serif;background:#f4f4f4;padding:20px}
  .card{max-width:560px;margin:auto;background:#fff;border-radius:14px;padding:20px;box-shadow:0 10px 25px rgba(0,0,0,.08)}
  h2{text-align:center;margin:0 0 10px}
  p{color:#555;text-align:center}
  input,button,select{width:100%;padding:12px;margin-top:12px;font-size:16px}
  button{background:#000;color:#fff;border:none;border-radius:10px;cursor:pointer}
  button:hover{opacity:.85}
  canvas{width:100%;margin-top:15px;border-radius:10px;background:#eee}
  .hint{font-size:13px;color:#777;margin-top:8px;text-align:center}
  .mockup{margin-top:20px;text-align:center}
  .shirt{width:260px;height:320px;margin:auto;position:relative;border-radius:20px;background:#fff;box-shadow:inset 0 0 0 2px #ddd}
  .print{position:absolute;top:90px;left:50%;transform:translateX(-50%);width:140px}
</style>
</head>
<body>
  <div class="card">
    <h2>üëï ‡∏£‡∏∞‡∏ö‡∏ö‡∏•‡∏≠‡∏Å‡∏•‡∏≤‡∏¢‡πÄ‡∏™‡∏∑‡πâ‡∏≠</h2>
    <p>‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏π‡∏õ ‚Üí ‡∏•‡∏≠‡∏Å‡∏•‡∏≤‡∏¢ ‚Üí ‡∏î‡∏π‡∏ö‡∏ô‡πÄ‡∏™‡∏∑‡πâ‡∏≠‡∏à‡∏£‡∏¥‡∏á ‚Üí ‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡∏™‡πà‡∏á‡∏£‡πâ‡∏≤‡∏ô</p>

    <input type="file" id="file" accept="image/*" />
    <select id="shirtColor" onchange="updateShirt()">
      <option value="#ffffff">‡πÄ‡∏™‡∏∑‡πâ‡∏≠‡∏™‡∏µ‡∏Ç‡∏≤‡∏ß</option>
      <option value="#000000">‡πÄ‡∏™‡∏∑‡πâ‡∏≠‡∏™‡∏µ‡∏î‡∏≥</option>
      <option value="#e5e5e5">‡πÄ‡∏™‡∏∑‡πâ‡∏≠‡∏™‡∏µ‡πÄ‡∏ó‡∏≤</option>
    </select>

    <button onclick="trace()">‡∏•‡∏≠‡∏Å‡∏•‡∏≤‡∏¢‡πÄ‡∏™‡∏∑‡πâ‡∏≠</button>
    <button onclick="exportPNG()">‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏ü‡∏•‡πå‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏£‡πâ‡∏≤‡∏ô‡∏™‡∏Å‡∏£‡∏µ‡∏ô</button>

    <canvas id="c"></canvas>

    <div class="mockup">
      <h3>‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ö‡∏ô‡πÄ‡∏™‡∏∑‡πâ‡∏≠</h3>
      <div class="shirt" id="shirt">
        <img id="printImg" class="print" />
      </div>
    </div>

    <div class="hint">‡∏ï‡∏≠‡∏ô‡∏ô‡∏µ‡πâ‡∏£‡πâ‡∏≤‡∏ô‡∏™‡∏Å‡∏£‡∏µ‡∏ô‡∏à‡∏∞‡πÄ‡∏´‡πá‡∏ô‡∏•‡∏≤‡∏¢‡∏ö‡∏ô‡πÄ‡∏™‡∏∑‡πâ‡∏≠‡∏Å‡πà‡∏≠‡∏ô‡∏û‡∏¥‡∏°‡∏û‡πå‡∏à‡∏£‡∏¥‡∏á</div>
  </div>

<script>
const canvas = document.getElementById('c');
const ctx = canvas.getContext('2d');
const printImg = document.getElementById('printImg');
const shirt = document.getElementById('shirt');

function updateShirt(){
  shirt.style.background = document.getElementById('shirtColor').value;
}

function trace(){
  const f = document.getElementById('file').files[0];
  if(!f){ alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏π‡∏õ'); return; }
  const img = new Image();
  img.onload = () => {
    canvas.width = img.width;
    canvas.height = img.height;
    ctx.clearRect(0,0,canvas.width,canvas.height);
    ctx.drawImage(img,0,0);

    const imageData = ctx.getImageData(0,0,canvas.width,canvas.height);
    const d = imageData.data;

    for(let i=0;i<d.length;i+=4){
      const gray = d[i]*0.299 + d[i+1]*0.587 + d[i+2]*0.114;
      const v = gray>140 ? 255 : 0;
      d[i]=d[i+1]=d[i+2]= v;
      d[i+3]= v===255 ? 255 : 0; // ‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á‡πÇ‡∏õ‡∏£‡πà‡∏á‡πÉ‡∏™
    }
    ctx.putImageData(imageData,0,0);

    // ‡πÅ‡∏™‡∏î‡∏á‡∏ö‡∏ô‡πÄ‡∏™‡∏∑‡πâ‡∏≠ mockup
    printImg.src = canvas.toDataURL('image/png');
  };
  img.src = URL.createObjectURL(f);
}

function exportPNG(){
  if(canvas.width===0){ alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏•‡∏≠‡∏Å‡∏•‡∏≤‡∏¢‡∏Å‡πà‡∏≠‡∏ô'); return; }
  const link = document.createElement('a');
  link.download = 'tshirt-print-ready.png';
  link.href = canvas.toDataURL('image/png');
  link.click();
}

updateShirt();
</script>
</body>
</html>
